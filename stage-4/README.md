# Minic阶段4：括号支持

## 🎯 学习目标
- 添加括号支持
- 理解语法优先级控制
- 掌握嵌套表达式解析

## 🚀 快速开始

### 获取阶段4代码
```bash
git clone https://github.com/zhnt/minic-s4.git
cd minic-s4
make
```

### 测试括号功能
```bash
echo "(2 + 3) * 4" | ./build/minic  # 20.00
echo "((1 + 2) * 3) + 4" | ./build/minic  # 13.00
```

## 📚 20分钟学习指南

### 第1步：理解括号作用（5分钟）
括号可以改变默认的运算顺序：
- `2 + 3 * 4` = 14 (先乘后加)
- `(2 + 3) * 4` = 20 (先加后乘)

### 第2步：实现括号解析（10分钟）
需要修改：
- `src/parser.c` - 添加括号表达式处理
- `src/compiler.c` - 确保正确的代码生成顺序

### 第3步：嵌套测试（5分钟）
```bash
# 单层括号
echo "(1 + 2) * 3" | ./build/minic  # 9.00

# 多层嵌套
echo "((1 + 2) * 3) + (4 * 5)" | ./build/minic  # 23.00
```

## 🔍 实现要点

### 1. 括号token
```c
TOKEN_LEFT_PAREN,   // 左括号 (
TOKEN_RIGHT_PAREN,  // 右括号 )
```

### 2. 表达式分组
```c
// 需要处理括号内的子表达式
// 递归下降解析
```

### 3. 错误处理
```c
// 处理不匹配的括号
// 处理空括号等情况
```

## 🎯 完成标准
- [ ] 支持单层括号
- [ ] 支持嵌套括号
- [ ] 正确处理复杂表达式

## 📋 测试用例
```bash
# 基础括号
echo "(5 + 3) * 2" | ./build/minic  # 16.00

# 嵌套括号
echo "((1 + 2) * 3) + 4" | ./build/minic  # 13.00

# 混合运算
echo "2 * (3 + 4) - (5 * 6)" | ./build/minic  # -16.00
```

## 📋 解锁下一阶段
完成本阶段后，老师会发布阶段5的代码。

## 📊 当前阶段信息
- **阶段**：4/12
- **功能**：括号支持
- **时间**：20分钟学习
- **状态**：已解锁

---
**记住：括号让表达式更灵活，编译器更智能！**